# Тестовое Задание

Это технический прототип градостроительной игры, выполненный в рамках тестового задания. В проекте реализованы модульная архитектура, система строительства и удаления зданий на сетке, сохранение/загрузка прогресса, гибкая система игровых режимов и продвинутое управление камерой.

**Время, затраченное на выполнение:** *7 часов*

---

## Ключевые технологии и особенности

- **Unity:** 2022.3.5f1
- **Dependency Injection:** Используется **Zenject** для управления зависимостями между системами (`GridManager`, `BuildingManager`, `InputHandler`, `PlayModeManager` и др.). Все зависимости настраиваются в `GameInstaller`, что обеспечивает слабую связанность, тестируемость и гибкость.
- **Модульность:** Код разделён на логические модули с помощью **Assembly Definitions (.asmdef)**. Это ускоряет компиляцию и облегчает поддержку.
- **Новая система ввода:** Управление построено на **New Input System**. Все действия реализованы через `InputActionAsset`, поддерживаются разные устройства ввода.
- **Сохранение и загрузка:** Данные о зданиях сохраняются и загружаются через **JSON-файл** (не через PlayerPrefs), что удобно для отладки и надёжно для пользователя.
- **UI и анимации:** Интерфейс реагирует на действия пользователя и анимирован с помощью **DOTween** (например, панель зданий плавно выезжает).
- **Гибкая настройка:** Все игровые данные (`BuildingDataSO` и др.) вынесены в **ScriptableObjects** — это позволяет гейм-дизайнерам легко добавлять контент без правки кода.

---

## Руководство пользователя

### Управление

- **Мышь:**
    - **Левая кнопка мыши (ЛКМ):**
        - В режиме `Place`: размещение выбранного здания.
        - В режиме `Remove`: удаление здания под курсором.
    - **Перетаскивание кнопки здания:** Зажмите ЛКМ на кнопке здания, перетащите на сетку и отпустите — здание разместится сразу.
- **UI-кнопки:**
    - "Place": Вход в режим строительства.
    - "Remove": Вход в режим удаления зданий.
    - "Save": Сохранить расположение зданий.
    - "Load": Загрузить прогресс.
- **Панель зданий:** Клик по кнопке — выбор здания. Повторный клик — отмена выбора.

### Управление камерой

- **Перемещение (Pan):**
    - **Клавиши:** `WASD` или стрелки.
    - **Мышь:** Зажмите ЛКМ на пустом месте и тяните, чтобы переместить камеру по карте.
- **Масштабирование (Zoom):**
    - **Колёсико мыши:** Прокрутка для приближения/отдаления.
    - **Клавиши:** `Q`/`E` или `-`/`=`.
    - **Сенсорный экран:** Пинч (щипок) двумя пальцами для масштабирования.

---

## Как добавить новое здание?

1. Создайте спрайт здания.
2. В папке `Assets/Data/Buildings` создайте новый ассет: `Create -> Building -> BuildingData`.
3. Назовите ассет по имени здания.
4. Настройте ассет:
    - **Building Sprite:** укажите спрайт.
    - **Width / Height:** задайте размер здания в клетках.
    - **ID / Name:** генерируются автоматически.
5. Добавьте ассет в список `Building Types` компонента `GameInstaller` на объекте `[SYSTEMS]` в сцене.

---

## Техническое описание

### Сетка и размещение

- **GridManager:** управляет логической сеткой, преобразует координаты между миром и сеткой.
- **Размер клетки (`cellSize`):** если PPU = 32, то спрайт 32x32 = 1 клетка, `cellSize = 1`.
- **Центрирование здания:** координаты рассчитываются с учётом ширины/высоты:
    - `offsetX = cellSize * (width / 2.0f - 0.5f)`
    - `offsetY = cellSize * (height / 2.0f - 0.5f)`
- **Проверка размещения:** `GridManager.IsAreaPlaceable()` проверяет, свободны ли клетки для размещения здания.
- **Визуальная подсветка:** свободные клетки выделяются голубым, занятые — красным.

### Архитектура на Zenject

- **GameInstaller:** настраивает все менеджеры и сервисы через Zenject.
- **InstallBindings():** связывает экземпляры менеджеров с контейнером Zenject.
- **[Inject]:** любой класс может получить нужный менеджер, просто объявив `[Inject] private GridManager gridManager;`.

---

## Обзор игровых построек

- **Scrap Shack (Дом игрока):** 5×4 тайла — основная база.
- **Repair Workshop:** мастерская для ремонта.
- **Recycler Furnace:** плавильня для переработки мусора.
- **Hydroponic Greenhouse:** гидропонная теплица.
- **Robot Barn:** сарай для роботов.
- **Scrap Foundry:** литейный цех.
- **Energy Reactor Hut:** энергостанция.
- **Junkyard Tavern (Robot Café):** кафе для роботов.
- **Drone Dock:** док для дронов.
- **Ancient Robot Temple:** древний храм роботов.

---

> **Все игровые механики реализованы с учётом модульности, расширяемости и удобства для разработки.**
> **Можно быстро добавлять новые здания, расширять логику, улучшать интерфейс и вводить новые режимы без переписывания ядра.**
